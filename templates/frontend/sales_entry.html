{% extends 'frontend/base.html' %}

{% block title %}Sales Entry - Vessel Sales System{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h2>
                    <i class="bi bi-cart-plus text-success"></i> 
                    Sales Entry
                </h2>
                <p class="text-muted mb-0">Record daily sales transactions quickly and easily</p>
            </div>
            <a href="{% url 'frontend:dashboard' %}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Back to Dashboard
            </a>
        </div>
    </div>
</div>

<!-- Sales Entry Form -->
<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-plus-circle"></i> New Sales Transaction
                </h5>
            </div>
            <div class="card-body">
                <form id="salesForm">
                    <!-- Vessel Selection -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-ship"></i> Select Vessel
                            </label>
                            <select class="form-select form-select-lg" required>
                                <option value="">Choose vessel...</option>
                                <option value="amman">Amman</option>
                                <option value="aylah">Aylah</option>
                                <option value="sinaa">Sinaa</option>
                                <option value="nefertiti">Nefertiti</option>
                                <option value="babel">Babel</option>
                                <option value="dahab">Dahab</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-calendar"></i> Transaction Date
                            </label>
                            <input type="date" class="form-control form-control-lg" value="{{ today|date:'Y-m-d' }}" required>
                        </div>
                    </div>

                    <!-- Product Search -->
                    <div class="mb-4">
                        <label class="form-label fw-bold">
                            <i class="bi bi-search"></i> Search Product
                        </label>
                        <div class="input-group input-group-lg">
                            <input type="text" class="form-control" placeholder="Type product name or scan barcode..." id="productSearch">
                            <button class="btn btn-outline-secondary" type="button" onclick="showComingSoon()">
                                <i class="bi bi-upc-scan"></i> Scan
                            </button>
                        </div>
                        <small class="text-muted">Start typing to search for products...</small>
                    </div>

                    <!-- Product Results (will be populated dynamically) -->
                    <div id="productResults" class="mb-4" style="display: none;">
                        <div class="card border-primary">
                            <div class="card-body">
                                <h6 class="card-title">Selected Product</h6>
                                <div id="selectedProduct"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Quantity and Price -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <label class="form-label fw-bold">
                                <i class="bi bi-123"></i> Quantity Sold
                            </label>
                            <input type="number" class="form-control form-control-lg" placeholder="0" min="0" step="1">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">
                                <i class="bi bi-currency-dollar"></i> Unit Price (JOD)
                            </label>
                            <input type="number" class="form-control form-control-lg" placeholder="0.000" min="0" step="0.001">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">
                                <i class="bi bi-calculator"></i> Total Revenue
                            </label>
                            <input type="text" class="form-control form-control-lg bg-light" readonly placeholder="0.000 JOD">
                        </div>
                    </div>

                    <!-- Current Stock Info -->
                    <div class="alert alert-info mb-4">
                        <h6 class="alert-heading">
                            <i class="bi bi-info-circle"></i> Current Stock Information
                        </h6>
                        <div class="row">
                            <div class="col-md-6">
                                <small><strong>Available Stock:</strong> <span class="text-primary">--</span></small>
                            </div>
                            <div class="col-md-6">
                                <small><strong>After Sale:</strong> <span class="text-success">--</span></small>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <button type="button" class="btn btn-outline-secondary btn-lg me-md-2">
                            <i class="bi bi-x-circle"></i> Clear Form
                        </button>
                        <button type="submit" class="btn btn-success btn-lg">
                            <i class="bi bi-check-circle"></i> Record Sale
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Recent Sales -->
<div class="row mt-5">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-clock-history"></i> Today's Sales
                </h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th><i class="bi bi-ship"></i> Vessel</th>
                                <th><i class="bi bi-box"></i> Product</th>
                                <th><i class="bi bi-123"></i> Quantity</th>
                                <th><i class="bi bi-currency-dollar"></i> Revenue</th>
                                <th><i class="bi bi-clock"></i> Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="5" class="text-center text-muted py-4">
                                    <i class="bi bi-cart-x" style="font-size: 2rem;"></i>
                                    <p class="mt-2 mb-0">No sales recorded today</p>
                                    <small>Use the form above to record your first sale</small>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// Simple product search simulation
document.getElementById('productSearch').addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase();
    const resultsDiv = document.getElementById('productResults');
    const selectedDiv = document.getElementById('selectedProduct');
    
    if (searchTerm.length > 2) {
        // Simulate product search results
        resultsDiv.style.display = 'block';
        selectedDiv.innerHTML = `
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h6 class="mb-1">Ø¨ÙŠØ¨Ø³ÙŠ 250 Ù…Ù„Ù„ (Sample Product)</h6>
                    <small class="text-muted">Item ID: 105 â€¢ Current Stock: 150 units</small>
                </div>
                <div class="text-end">
                    <div class="badge bg-success">In Stock</div>
                    <small class="d-block text-muted">0.500 JOD</small>
                </div>
            </div>
        `;
    } else {
        resultsDiv.style.display = 'none';
    }
});

// Form submission
document.getElementById('salesForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Show success message
    const alertHtml = `
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle"></i> 
            <strong>Success!</strong> Sale recorded successfully. This will integrate with your backend soon.
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    `;
    
    this.insertAdjacentHTML('beforebegin', alertHtml);
    this.reset();
    document.getElementById('productResults').style.display = 'none';
});

function showComingSoon() {
    alert('ðŸš€ Barcode scanning feature coming soon!');
}
</script>
{% endblock %}